<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; try_docs v1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=2b4fdbf1" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5cb08e4e"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script src="_static/my_custom.js?v=679418e8"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Get Started" href="Page_3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README_Page_1.html">TNLearn: Task-based Neurons for learning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#quick-links">Quick links</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#motivation">Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#benchmarks">Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#resource">Resource</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#dependences">Dependences</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#quick-start">Quick start</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#api-documentation">API documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#citation">Citation</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#the-team">The Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="README_Page_1.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Page_2.html">Introduction and Guidelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Page_2.html#why-task-based-neurons">Why Task-based Neurons?</a></li>
<li class="toctree-l2"><a class="reference internal" href="Page_2.html#what-are-task-based-neurons">What Are Task-based Neurons?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Page_2.html#vectorized-symbolic-regression">1. Vectorized Symbolic Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="Page_2.html#parameterization">2. Parameterization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Page_2.html#when-to-use-task-based-neurons">When to use Task-based Neurons?</a></li>
<li class="toctree-l2"><a class="reference internal" href="Page_2.html#whats-next">What’s Next?</a></li>
<li class="toctree-l2"><a class="reference internal" href="Page_2.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Page_3.html">Get Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Page_3.html#packages-required">Packages Required</a></li>
<li class="toctree-l2"><a class="reference internal" href="Page_3.html#basic-install-by-pip">Basic Install by pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="Page_3.html#build-shared-libraries-from-source">Build Shared Libraries from Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="Page_3.html#what-s-next">What’s Next</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tnlearn-vecsymregressor">tnlearn.VecSymRegressor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tnlearn-mlpclassifier">tnlearn.MLPClassifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tnlearn-mlpregressor">tnlearn.MLPRegressor</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">try_docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Page_4.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tnlearn.VecSymRegressor</span></code></p></td>
<td><p>Symbolic Regression with Regressor Class</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tnlearn.MLPClassifier</span></code></p></td>
<td><p>MLPClassifier Class Implementation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tnlearn.MLPRegressor</span></code></p></td>
<td><p>MLPRegressor Class Implementation</p></td>
</tr>
</tbody>
</table>
<section id="tnlearn-vecsymregressor">
<h2>tnlearn.VecSymRegressor<a class="headerlink" href="#tnlearn-vecsymregressor" title="Link to this heading"></a></h2>
<ul>
<li><dl>
<dt>Description:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">tnlearn.VecSymRegressor</span></code> implements the symbolic regression algorithm through the Regressor class, enabling the evolution of mathematical expressions to fit given data. The class provides methods for generating random expressions, evaluating their fitness, and evolving expressions through mutation and crossover. It aims to find the best-fitting mathematical model for a given dataset.</p>
<div class="custom-background docutils container">
<p><code class="docutils literal notranslate"><span class="pre">tnlearn.VecSymRegressor</span></code> : <span class="classtext">class</span> <strong>tnlearn.VecSymRegressor</strong> <span class="classtext">(random_state=100, pop_size=5000, max_generations=20, tournament_size=10, x_pct=0.7, xover_pct=0.3, save=True, operations=None)</span></p>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>How to initialize your</strong> <code class="docutils literal notranslate"><span class="pre">VecSymRegressor</span></code> <strong>:</strong></dt><dd><p><code class="docutils literal notranslate"><span class="pre">random_state</span></code>：Seed for random number generation <strong>(default: 100)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">pop_size</span></code>：Population size for genetic algorithm <strong>(default: 5000)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">max_generations</span></code>：Maximum generations for genetic algorithm <strong>(default: 20)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">tournament_size</span></code>：Size of tournament selection <strong>(default: 10)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">x_pct</span></code>：Probability of selecting a variable node during random program generation <strong>(default: 0.7)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">xover_pct</span></code>：Crossover probability during offspring generation <strong>(default: 0.3)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">save</span></code>：Flag for saving <strong>(default: False)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>False:</strong> Don’t need to save the progress</p>
<p><strong>True:</strong> If save option is enabled, open a file called <strong>“log.txt”</strong> to log the progress</p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">operations</span></code>：Set of operations to be used in program generation <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>None:</strong> Use the defult mathematical operations for the algorithm, like the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="p">(</span>
<span class="linenos">2</span><span class="p">{</span><span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="s2">&quot;arg_count&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;format_str&quot;</span><span class="p">:</span> <span class="s2">&quot;(</span><span class="si">{}</span><span class="s2"> + </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="p">},</span>
<span class="linenos">3</span><span class="p">{</span><span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="s2">&quot;arg_count&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;format_str&quot;</span><span class="p">:</span> <span class="s2">&quot;(</span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="p">},</span>
<span class="linenos">4</span><span class="p">{</span><span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="s2">&quot;arg_count&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;format_str&quot;</span><span class="p">:</span> <span class="s2">&quot;(</span><span class="si">{}</span><span class="s2"> * </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="p">},</span>
<span class="linenos">5</span><span class="p">{</span><span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">neg</span><span class="p">,</span> <span class="s2">&quot;arg_count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;format_str&quot;</span><span class="p">:</span> <span class="s2">&quot;-(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="p">},</span>
<span class="linenos">6</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also define <code class="docutils literal notranslate"><span class="pre">operations</span></code> in a similar way.</p>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><p><strong>Here is an example of using</strong> <code class="docutils literal notranslate"><span class="pre">VecSymRegressor</span></code> <strong>quickly:</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tnlearn</span> <span class="kn">import</span> <span class="n">Regressor</span>

<span class="o">&gt;&gt;</span> <span class="n">neuron</span> <span class="o">=</span> <span class="n">Regressor</span><span class="p">()</span>
<span class="o">&gt;&gt;</span> <span class="n">neuron</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">neuron</span><span class="o">.</span><span class="n">neuron</span><span class="p">)</span>

<span class="o">********************</span>
<span class="mi">6</span><span class="nd">@x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">1.46</span><span class="nd">@x</span> <span class="o">-</span> <span class="mf">0.1316</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Format <code class="docutils literal notranslate"><span class="pre">X_train</span></code> and <code class="docutils literal notranslate"><span class="pre">y_label</span></code> as <strong>numpy arrays</strong>.</p>
<p>In the above example, the shapes of <code class="docutils literal notranslate"><span class="pre">X_train</span></code> and <code class="docutils literal notranslate"><span class="pre">y_label</span></code> are <strong>(600, 10)</strong> and <strong>(600, 1)</strong> respectively.</p>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="tnlearn-mlpclassifier">
<h2>tnlearn.MLPClassifier<a class="headerlink" href="#tnlearn-mlpclassifier" title="Link to this heading"></a></h2>
<ul>
<li><dl>
<dt>Description:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">tnlearn.MLPClassifier</span></code> implements the class MLPClassifier, which extends the functionality of the base class to build and train a Multi-layer Perceptron (MLP) model. MLPClassifier is designed to allow easy customization of the neural network structure, activation functions, and loss function used during training. It incorporates device selection to leverage available GPU resources, ensuring efficient computation. The class covers essential methods for model training, evaluation, and prediction, making it a flexible tool for supervised learning tasks in PyTorch.</p>
<div class="custom-background docutils container">
<p><code class="docutils literal notranslate"><span class="pre">tnlearn.MLPClassifier</span></code> : <span class="classtext">class</span> <strong>tnlearn.MLPClassifier</strong> <span class="classtext">(neurons=’x’, layers_list=None, activation_funcs=None, loss_function=None, optimizer_name=’adam’, random_state=1, max_iter=300, batch_size=128, valid_size=0.2, lr=0.01, visual=False, save=False, visual_interval=100, gpu=None, interval=None, scheduler=None, l1_reg=None, l2_reg=None)</span></p>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>How to initialize your</strong> <code class="docutils literal notranslate"><span class="pre">tnlearn.MLPClassifier</span></code> <strong>:</strong></dt><dd><p><code class="docutils literal notranslate"><span class="pre">neurons</span></code>: Neuronal expression <strong>(default: ‘x’)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p>Users can pass the results of <code class="docutils literal notranslate"><span class="pre">tnlearn.VecSymRegressor</span></code> to <code class="docutils literal notranslate"><span class="pre">neurons</span></code></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">layers_list</span></code>: List of neuron counts for each hidden layer <strong>(default: [50, 30, 10])</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">activation_funcs</span></code>: Activation functions <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p>Users can choose different activation functions: <code class="docutils literal notranslate"><span class="pre">'relu'</span></code>, <code class="docutils literal notranslate"><span class="pre">'leakyrelu'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sigmoid'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tanh'</span></code>,  <code class="docutils literal notranslate"><span class="pre">'softmax'</span></code></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">loss_function</span></code>: Loss function for the training process <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p>Users can choose different loss functions: <code class="docutils literal notranslate"><span class="pre">'mse'</span></code>, <code class="docutils literal notranslate"><span class="pre">'l1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'crossentropy'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bce'</span></code></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">optimizer_name</span></code>: Name of the optimizer algorithm <strong>(default: ‘adam’)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p>Users can choose different optimizers: <code class="docutils literal notranslate"><span class="pre">'adam'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sgd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'rmsprop'</span></code>, <code class="docutils literal notranslate"><span class="pre">'adamw'</span></code></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">random_state</span></code>: Seed for random number generators for reproducibility <strong>(default: 1)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">max_iter</span></code>: Maximum number of training iterations <strong>(default: 300)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">batch_size</span></code>: Number of samples per batch during training <strong>(default: 128)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">valid_size</span></code>: Fraction of training data used for validation <strong>(default: 0.2)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">lr</span></code>: Learning rate for the optimizer <strong>(default: 0.01)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">visual</span></code>: Boolean indicating if training visualization is to be shown <strong>(default: False)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">save</span></code>: Indicates if the training figure should be saved <strong>(default: False)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">visual_interval</span></code>: Interval at which training visualization is updated <strong>(default: 100)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">gpu</span></code>: Specifies GPU configuration for training <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>None</strong>: Not use GPU</p>
<p><strong>An Integer (e.g. 1)</strong>: How many GPUs you want to use</p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">interval</span></code>: Interval of screen output during training <strong>(default: None)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">scheduler</span></code>: Learning rate scheduler <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>None</strong>:  Not use any learning rate adjustment strategy</p>
<p><strong>{‘step_size’: 30, ‘gamma’: 0.2}</strong>:  Use <code class="docutils literal notranslate"><span class="pre">lr_sceduler.StepLR()</span></code> with <strong>“step_size = 30”</strong> and <strong>“gamma = 0.2”</strong></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">l1_reg</span></code>: L1 regularization term <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>None</strong>:  Not use L1 regularization</p>
<p><strong>True</strong>:  Use L1 regularization</p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">l2_reg</span></code>: L2 regularization term <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>None</strong>:  Not use L2 regularization</p>
<p><strong>True</strong>:  Use L2 regularization</p>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><p><strong>Here is an example of using</strong> <code class="docutils literal notranslate"><span class="pre">MLPClassifier</span></code> <strong>quickly:</strong></p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">tnlearn</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">tnlearn</span> <span class="kn">import</span> <span class="n">VecSymRegressor</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">neuron</span> <span class="o">=</span> <span class="n">VecSymRegressor</span><span class="p">()</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="n">neuron</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="linenos">12</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="linenos">13</span><span class="nb">print</span><span class="p">(</span><span class="n">neuron</span><span class="o">.</span><span class="n">neuron</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="n">layers_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="linenos">16</span><span class="n">clf</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">()</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="linenos">19</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="n">clf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_model_dir&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;mlp_classifier.pth&#39;</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">clf</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_model_dir&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;mlp_classifier.pth&#39;</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">output_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">23</span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="tnlearn-mlpregressor">
<h2>tnlearn.MLPRegressor<a class="headerlink" href="#tnlearn-mlpregressor" title="Link to this heading"></a></h2>
<ul>
<li><dl>
<dt>Description:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">tnlearn.MLPRegressor</span></code> embodies the MLPRegressor class, designed as an extension of BaseModel within a custom machine learning framework. It facilitates the creation and training of a multilayer perceptron (MLP) for regression tasks. Features of the class include the flexibility to define custom neural network architectures through parameters such as neuronal expression and layer structure, the utilization of various activation functions, and the incorporation of modern optimization algorithms and regularization techniques. Moreover, the class is equipped with optional GPU support for enhanced computational efficiency, as well as functionalitiesfor training visualization, validation, and model performance evaluation. This representation of an MLP is tailored to adapt to an array of regression problems while ensuring ease of use and extensibility.</p>
<div class="custom-background docutils container">
<p><code class="docutils literal notranslate"><span class="pre">tnlearn.MLPRegressor</span></code> : <span class="classtext">class</span> <strong>tnlearn.MLPRegressor</strong> <span class="classtext">(neurons=’x’, layers_list=None, activation_funcs=None, loss_function=None, optimizer_name=’adam’, random_state=1, max_iter=300, batch_size=128, valid_size=0.2, lr=0.01, visual=False, save=False, visual_interval=100, gpu=None, interval=None, scheduler=None, l1_reg=None, l2_reg=None)</span></p>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>How to initialize your</strong> <code class="docutils literal notranslate"><span class="pre">tnlearn.MLPRegressor</span></code> <strong>:</strong></dt><dd><p><code class="docutils literal notranslate"><span class="pre">neurons</span></code>: Neuronal expression <strong>(default: ‘x’)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p>Users can pass the results of <code class="docutils literal notranslate"><span class="pre">tnlearn.VecSymRegressor</span></code> to <code class="docutils literal notranslate"><span class="pre">neurons</span></code></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">layers_list</span></code>: List of neuron counts for each hidden layer <strong>(default: [50, 30, 10])</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">activation_funcs</span></code>: Activation functions <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p>Users can choose different activation functions: <code class="docutils literal notranslate"><span class="pre">'relu'</span></code>, <code class="docutils literal notranslate"><span class="pre">'leakyrelu'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sigmoid'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tanh'</span></code>,  <code class="docutils literal notranslate"><span class="pre">'softmax'</span></code></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">loss_function</span></code>: Loss function for the training process <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p>Users can choose different loss functions: <code class="docutils literal notranslate"><span class="pre">'mse'</span></code>, <code class="docutils literal notranslate"><span class="pre">'l1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'crossentropy'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bce'</span></code></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">optimizer_name</span></code>: Name of the optimizer algorithm <strong>(default: ‘adam’)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p>Users can choose different optimizers: <code class="docutils literal notranslate"><span class="pre">'adam'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sgd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'rmsprop'</span></code>, <code class="docutils literal notranslate"><span class="pre">'adamw'</span></code></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">random_state</span></code>: Seed for random number generators for reproducibility <strong>(default: 1)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">max_iter</span></code>: Maximum number of training iterations <strong>(default: 300)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">batch_size</span></code>: Number of samples per batch during training <strong>(default: 128)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">valid_size</span></code>: Fraction of training data used for validation <strong>(default: 0.2)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">lr</span></code>: Learning rate for the optimizer <strong>(default: 0.01)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">visual</span></code>: Boolean indicating if training visualization is to be shown <strong>(default: False)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">save</span></code>: Indicates if the training figure should be saved <strong>(default: False)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">visual_interval</span></code>: Interval at which training visualization is updated <strong>(default: 100)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">gpu</span></code>: Specifies GPU configuration for training <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>None</strong>: Not use GPU</p>
<p><strong>An Integer (e.g. 1)</strong>: How many GPUs you want to use</p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">interval</span></code>: Interval of screen output during training <strong>(default: None)</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">scheduler</span></code>: Learning rate scheduler <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>None</strong>:  Not use any learning rate adjustment strategy</p>
<p><strong>{‘step_size’: 30, ‘gamma’: 0.2}</strong>:  Use <code class="docutils literal notranslate"><span class="pre">lr_sceduler.StepLR()</span></code> with <strong>“step_size = 30”</strong> and <strong>“gamma = 0.2”</strong></p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">l1_reg</span></code>: L1 regularization term <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>None</strong>:  Not use L1 regularization</p>
<p><strong>True</strong>:  Use L1 regularization</p>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">l2_reg</span></code>: L2 regularization term <strong>(default: None)</strong></p>
<blockquote>
<div><div class="custom-background-2 docutils container">
<p><strong>None</strong>:  Not use L2 regularization</p>
<p><strong>True</strong>:  Use L2 regularization</p>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><p><strong>Here is an example of using</strong> <code class="docutils literal notranslate"><span class="pre">MLPRegressor</span></code> <strong>quickly:</strong></p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">tnlearn</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">tnlearn</span> <span class="kn">import</span> <span class="n">VecSymRegressor</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">neuron</span> <span class="o">=</span> <span class="n">VecSymRegressor</span><span class="p">()</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="n">neuron</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="linenos">12</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="linenos">13</span><span class="nb">print</span><span class="p">(</span><span class="n">neuron</span><span class="o">.</span><span class="n">neuron</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="n">layers_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="linenos">16</span><span class="n">clf</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">()</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="linenos">19</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="n">clf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_model_dir&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;mlp_regressor.pth&#39;</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">clf</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_model_dir&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;mlp_regressor.pth&#39;</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">output_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">23</span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Page_3.html" class="btn btn-neutral float-left" title="Get Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Finn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>